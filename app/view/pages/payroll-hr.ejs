<!DOCTYPE html>

<html lang="en">
<head>
   <%include ../partials/head %>
   <title>Payroll - HR</title>
</head>

<body>

<%include ../partials/navbar %>


<div class="wrapper">
    <!-- Sidebar Holder -->
    <%include ../partials/sidebar %>

    <!-- Page Content Holder -->
    <div id="content" class="main-content">
            <h4>Payroll</h4>
        <ul class="nav nav-tabs">
                <li role="presentation" class="active"><a href="../payroll/hr">Human resources</a></li>
            <li role="presentation"><a href="../payroll/drivers">Drivers</a></li>
        </ul>
        <div class="tab-content"> 
            <div class="content">
                <div class="row">
                    <div class="col-md-6">
                        

                        <form>
                            <div class="radio">
                                <label class="radio">
                                <input type="radio" name="POSITION" id="Radio3" value="FIELD CREW OPERATOR"> FIELD CREW OPERATOR
                                </label>
                                <label class="radio">
                                <input type="radio" name="POSITION" id="Radio3" value="FIELD CREW MANAGER"> FIELD CREW MANAGER
                                </label>
                                <label class="radio">
                                <input type="radio" name="POSITION" id="Radio3" value="FIELD CREW SUPERVISOR"> FIELD CREW SUPERVISOR
                                </label>
                                <label class="radio">
                                <input type="radio" name="POSITION" id="Radio3" value="OPERATIONS"> OPERATIONS
                                </label>
                                <label class="radio">
                                <input type="radio" name="POSITION" id="Radio3" value="MECHANICS"> MECHANICS
                                </label>
                                <label class="radio">
                                <input type="radio" name="POSITION" id="Radio3" value="OFFICE"> OFFICE
                                </label>
                            </div>
                        </form>
                    </div>
                    <div class="col-md-6">
                        <br/>
                        <br/>
                        <select class="form-control" id="selectedHr">
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6">
                        <form class="form-horizontal">
                        <div class="form-group">
                            <label for="id" class="control-label col-xs-4">id</label>
                            <div class="col-xs-8">
                                <input class="form-control" id="id" type="text" value="" disabled>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="name" class="control-label col-xs-4">Name</label>
                            <div class="col-xs-8">
                                <input class="form-control" id="name" type="text" value="" disabled>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="position" class="control-label col-xs-4">Position</label>
                            <div class="col-xs-8">
                                <input class="form-control" id="position" type="text" value="" disabled>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="email" class="control-label col-xs-4">email</label>
                            <div class="col-xs-8">
                                <input class="form-control" id="email" type="text" value="" disabled>
                            </div>
                        </div>
                        
                        </form>
                    </div>
                    <div class="col-md-6">
                        <form class="form-horizontal">
                        <div class="form-group">
                            <label for="phone" class="control-label col-xs-4">Phone</label>
                            <div class="col-xs-8">
                                <input class="form-control" id="phone" type="text" value="" disabled>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="dllshr" class="control-label col-xs-4">dlls / hr</label>
                            <div class="col-xs-8">
                                <input class="form-control" id="dllshr" type="text" value="" disabled>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="ssn" class="control-label col-xs-4">ssn</label>
                            <div class="col-xs-8">
                                <input class="form-control" id="ssn" type="text" value="" disabled>
                            </div>
                        </div>
                        
                        </form>
                    </div>
                </div>
                <div class = "row">
                    <h4> Clockin events</h4>
                    <table id='grid-basic' border="1" class="table table-bordered table-condensed table-hover table-striped" >
                    <thead>
                        <tr>
                            <th data-column-id="id" data-type="numeric" data-width="10%">Clockin No.</th>
                            <th data-column-id="evento" data-formatter="link">UUID</th>
                            <th data-column-id="in" >In</th>
                            <th data-column-id="out">Out</th>
                            <th data-column-id="hours-worked">Hours worked</th>
                            <!-- th data-column-id="demerge-amount" data-formatter="demerge">Demerge amount</th -->
                            <th data-column-id="options" data-formatter="commands" data-sortable="false">Options</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="quote">
                            <td id=""></td>
                            <td id=""></td>
                            <td id=""></td>
                            <td id=""></td>
                            <td id=""></td>
                            <!--td id=""></td-->
                            <td id=""></td>
                        </tr>
                    </tbody>
                    </table>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <button id="validate" type="button" class="btn btn-secondary pull-right" disabled>Validate</button>
                    </div>
                </div>
                <div class = "row">
                    <h4> Payroll entries</h4>
                    <table id='grid-payroll' border="1" class="table table-bordered table-condensed table-hover table-striped" >
                    <thead>
                        <tr>
                            <th data-column-id="id" data-type="numeric" data-width="10%">Payroll No.</th>
                            <th data-column-id="amount">Amount</th>
                            <th data-column-id="hours-worked">Hours Worked</th>
                            <th data-column-id="date">Date</th>
                            <th data-column-id="wire-transfer">Wire Transfer</th>
                            <th data-column-id="options" data-formatter="commands" data-sortable="false">Options</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="quote">
                            <td id=""></td>
                            <td id=""></td>
                            <td id=""></td>
                            <td id=""></td>
                            <td id=""></td>
                            <td id=""></td>
                        </tr>
                    </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
    
<!-- wireTransferModal -->
<div id="wireTransferModal" class="modal fade" tabindex="-1" role="dialog">
<div class="modal-dialog" role="document">
    <div class="modal-content">
    <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Capture wire transfer</h4>
    </div>
    <div class="modal-body">
        <label for="id" class="control-label col-xs-4">Wire Transfer</label>
        <div class="col-xs-8">
            <input class="form-control" id="wireTransferInput" type="text" value="">
        </div>
        <br/>
        <br/>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <button id="accepted" type="button" class="btn btn-primary">Save changes</button>
    </div>
    </div><!-- /.modal-content -->
</div><!-- /.modal-dialog -->
</div><!-- /.modal -->


    <!-- <script src="/socket.io/socket.io.js"></script>  -->
    <%include ../partials/js %>

    <!-- Ticket detail modal  -->
    <!--<%include ../partials/ticket-detail %>-->
    <script>
        //var socket = io.connect('http://localhost:3000');
    </script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('#sidebarCollapse').on('click', function () {
                $('#sidebar').toggleClass('active');
            });
        });

        
        $("input[name='POSITION']").click(function() {

            $("#selectedHr").html("<option value='0'> please select </option>");
            $.ajax({
                url: '/api/payroll/hr',
                method: 'POST',
                data: {
                    position: this.value,
                },
                success: function(data){
                    var sel = document.getElementById('selectedHr');
                    var fragment = document.createDocumentFragment();

                    data.forEach(function(hr, index) {
                        var opt = document.createElement('option');
                        opt.innerHTML = hr.name;
                        opt.value = hr.id;
                        fragment.appendChild(opt);
                    });

                    sel.appendChild(fragment);    
                },
                error: function(){
                    alert('Please try again');
                }
            });
        });

        $("#selectedHr").on('change', function() {
            
            if (this.value != "0") {
                $.ajax({
                    url: '/api/payroll/byId',
                    method: 'POST',
                    data: {
                        id: this.value,
                    },
                    success: function(hr){
                        $("#id").val(hr[0].id);
                        $("#name").val(hr[0].name);
                        $("#position").val(hr[0].position);
                        $("#email").val(hr[0].email);
                        $("#phone").val(hr[0].tel);
                        $("#dllshr").val(hr[0].dll_hr);
                        $("#ssn").val(hr[0].ssn);

                        //Recargar Bottgrid
                        $('#grid-basic').bootgrid('destroy');
                        $('#grid-payroll').bootgrid('destroy');
                        initGrid(hr[0].id);
                        initGridPayroll(hr[0].id);

                        $('#validate').prop("disabled", false);
                    },
                    error: function(){
                        alert('Please try again');
                    }
                });
            }
            
            
        })

        function initGrid(payroll_id) {
            var grid = $("#grid-basic").bootgrid({
                ajax: true,
                ajaxSettings: {
                    method: "GET",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    cache: false
                },
                url: "/api/payroll/getClockinById/" + payroll_id,
                caseSensitive: false,
                formatters: {
                    "link": function(column, row)
                    {
                        return "<a href=\"#myModal\" data-toggle=\"modal\" data-ticket=\"" + row.id +  "\" class=\"text-center black-link show-ticket\">" + row.evento + "</a>";
                    },
                    "commands": function(column, row)
                    {
                        return "<input class=\"validate\" type=\"checkbox\" value=\"" + row.id + "\"></label>" 
                    }//,
                    //"demerge": function(column, row){
                    //    return "<input class=\"form-control cedar-dmg\" type=\"number\" value=\"0.00\" data-row-id=\""+ row.id +"\" step=\"0.01\" placeholder=\"0.00\">" 
                    //}
                }
            }).on("loaded.rs.jquery.bootgrid", function()
            {
                /* Executes after data is loaded and rendered */
                grid.find('.cedar-dmg').on('change', function(){
                    var currentValue = $(this).val() == '' ? 0 : $(this).val();
                    var convertedValue = parseFloat(currentValue).toFixed(2);
                    $(this).val(convertedValue);
                });
                grid.find(".command-edit").on("click", function(e)
                {
                    //alert("You pressed edit on row with the Id: " + $(this).data("row-id") + " and driver Id: " + $("#driverSelect").val() + "and product Id: " + $("#productsSelect").val());
                })
            });
        }
        
        function initGridPayroll(payroll_id) {
            var grid = $("#grid-payroll").bootgrid({
                ajax: true,
                ajaxSettings: {
                    method: "GET",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    cache: false
                },
                url: "/api/payroll/getPayrollHrById/" + payroll_id,
                caseSensitive: false,
                rowCount: [50,75,100,-1],
                formatters: {
                    "commands": function(column, row)
                    {
                        return "<button type=\"button\" class=\"btn btn-md btn-secondary command-payroll-to-pdf\" data-row-id=\"" + row.id + "\">PDF</button>" 
                    }
                }
            }).on("loaded.rs.jquery.bootgrid", function()
            {
                /* Executes after data is loaded and rendered */
                grid.find(".command-payroll-to-pdf").on("click", function(e)
                {
                    $.ajax({
                        url: '/api/payroll/getPDFInformationHr/' + $(this).data("row-id"),    
                        type: 'GET',   
                        data: {},      //Data as js object
                        success: function (msj) {
                            payrollToPdf(msj);
                        },
                        error: function(err) {
                            alert("Error occured. please try again: " + err);
                        },
                    })
                });
            });
        }

        $("#validate").click(function() {
            $('#wireTransferModal').modal('show');
        });

        $("#accepted").click(function() {
            var clockinList = [];
            $('.validate:checkbox:checked').each(function() {
                clockinList.push($(this).val());
            });

            //var demergeAmount = clockinList
            //                        .reduce((demergeAmt, current) => {
            //                            var toAdd = parseFloat($('.cedar-dmg[data-row-id="'+ current +'"]').val());
            //                            return demergeAmt + toAdd;
            //                        }, 0)
            //                        .toFixed(2);

            if($("#dllshr").val() == null || $("#dllshr").val() == undefined || $("#dllshr").val() == ""){
                alert("please define dlls/hr for selected user");
                return // TODO: hacer una prueba con un hr sin dlls_hr para ver si corre el codigo de abajo (en distintos navegadores)!!
            }

            if (clockinList != ''){

                $.ajax({
                    url: '/api/payroll/createPayrollEntry/',    
                    type: 'POST',   
                    data: {
                        clockinList: clockinList,
                        id: $("#id").val(),
                        dllsHr: $("#dllshr").val(),
                        wireTransfer: $("#wireTransferInput").val()
                        //demergeAmount: demergeAmount
                    },      //Data as js object
                    success: function (msj) {
                        alert(msj.message || msj);
                        $('#grid-basic').bootgrid('destroy');
                        $('#grid-payroll').bootgrid('destroy');
                        initGrid($("#id").val());
                        initGridPayroll($("#id").val());
                        $('#wireTransferModal').modal('hide');
                        $("#wireTransferInput").val("");
                    },
                    error: function(xhr) {
                        $('#wireTransferModal').modal('hide');
                        alert("Error occured. please try again");
                    },
                })
            }
            else {
                alert("No clockin event(s) selected")
            }
        })

        //$('li[id^="li_sdbr"]').removeClass('active');
        $('li[id="li_sdbr_payroll"]').addClass('active');

        function payrollToPdf(msj) {

            // Default export is a4 paper, portrait, using milimeters for units
            var doc = new jsPDF('p', 'mm', 'letter');

            // Primera columna
            doc.setFontSize(14);
            doc.text(20, 30, 'Fevid Transport LLC.');
            doc.setFontSize(10);
            doc.text(20, 40, 'Address: 10800 WCR 72');
            doc.text(20, 45, 'Midland TX 79705');

            // Segunda columna
            doc.text(100, 40, 'Phone: 432-305-5277');
            doc.text(100, 45, 'Email: nuviag@sandrevolution.com');

            // Primera columna
            doc.text(20, 55, 'Employee Name: ' + msj.hr[0].name);
            doc.text(20, 60, 'Address: ' + msj.hr[0].address);

            // Segunda columna
            // TODO: Hay que mejorar este codigo, puede fallar si no hay clockinevents (algo que no deberia pasar)
            doc.text(100, 55, 'Pay Begin Date: ' + msj.clockins[0].in);
            doc.text(100, 60, 'Pay End Date: ' + msj.clockins[msj.clockins.length-1].out);

            // Primera columna
            doc.text(20, 70, 'Current Earings');
            
            doc.setFontSize(8);
            doc.text(20, 80, 'clockin No.');
            doc.text(40, 80, 'In');
            doc.text(70, 80, 'Out')
            doc.text(100, 80, 'Time Worked')
            doc.text(130, 80, 'Amount')
            var actualLine = 85;


            // TODO: hay que agregar algun tipo de execpion para que no se puedan hacer payrolls si no hay nada que pagar
            for (var i = 0; i < msj.clockins.length; i++) {
                doc.text(20, actualLine, '' + msj.clockins[i].id);
                doc.text(40, actualLine, '' + msj.clockins[i].in);
                doc.text(70, actualLine, '' + msj.clockins[i].out);
                doc.text(100, actualLine, '' + msj.clockins[i].hours_worked);

                var a = msj.clockins[i].hours_worked.split(':');
                var seconds = (+a[0]) * 60 * 60 + (+a[1]) * 60 + (+a[2]);
                var amount = seconds/60/60*$("#dllshr").val()
                doc.text(130, actualLine, '$ ' + amount.toFixed(2));

                actualLine = actualLine + 5; // salto de linea en el PDF
            }

            actualLine = actualLine + 10;
            //doc.text(100, actualLine, 'Demerge Amount:');
            //doc.text(130, actualLine, '$ ' + msj.payroll[0].demerge.toFixed(2));

            //actualLine = actualLine + 5;
            doc.text(100, actualLine, 'Total:');
            doc.text(130, actualLine, '$ ' + msj.payroll[0].amount.toFixed(2));
            

            
            var imgData = 'data:image/jpeg;base64,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'

            //doc.addImage(img , horizontal, vertical, 100, 92)
            doc.addImage(imgData , 160, 240, 25, 23);

            doc.save('payroll_'+ msj.payroll[0].id +'.pdf');
        }
        

        
    </script>




</body>
</html>