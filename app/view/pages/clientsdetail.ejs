<!DOCTYPE html>

<html lang="en">
<head>
   <%include ../partials/head %>
   <title>Clients</title>
</head>

<body>

<%include ../partials/navbar %>

<div class="wrapper">
        <!-- Sidebar Holder -->
        <%include ../partials/sidebar %>

        <!-- Page Content Holder -->
        <div id="content">
            <ul class="nav nav-tabs">
                    <li role="presentation" class="active"><a href="../../administrative/clients">Clients</a></li> <!-- ../../ porque ahora la url tiene el Id del cliente -->
                    <li role="presentation"><a href="../../administrative/hr">Human resources</a></li>
                    <li role="presentation"><a href="../../administrative/drivers">Drivers</a></li>
            </ul>
            <div class="tab-content"> 
                <div class="content">
                    
                    <div class="row">
                        <div class="col-md-12">
                            <%if (client.length > 0) { %>
                                <%= client[0].name %>
                                <%= client[0].address %>
                            <% } %>
                        </div>
                    </div>


                    <br/>
                    <div class="row">
                        <div class="col-md-12">
                            <h4>Locations</h4>
                            <table id='grid-locations' border="1" class="table table-bordered table-condensed table-hover table-striped" >
                                <thead>
                                    <tr>
                                        <th data-column-id="id" data-type="numeric" data-formatter="link">#</th>
                                        <th data-column-id="name">Name</th>
                                        <th data-column-id="status">Status</th>
                                        <th data-column-id="start">Start Date</th>
                                        <th data-column-id="end">End Date</th>
                                        <th data-column-id="options" data-formatter="commands" data-sortable="false">Options</th>
                                    </tr>
                                </thead>
                                <%if (locations.length > 0) { %>
                                <tbody>
                                    <% for(var i=0; i<locations.length; i++) {%>
                                        <tr class="quote">
                                            <td id=""> <%= i+1 %> </td>
                                            <td id=""> <%= locations[i].name %> </td>
                                            <td id=""> <%= locations[i].status %> </td>
                                            <td id=""> <%= locations[i].start_date %> </td>
                                            <td id=""> <%= locations[i].end_date %> </td>
                                        </tr>
                                    <% } %>
                                </tbody>
                                <% } else{ %>  
                                    <tbody>
                                        <!--<p>No locations</p>-->
                                    </tbody>
                                <% } %>
                            </table>
                        </div>
                    </div>
                    <div class="row">
                            <div class="col-md-12">
                                <h4>Facilities</h4>
                                <table id='grid-facilities' border="1" class="table table-bordered table-condensed table-hover table-striped" >
                                    <thead>
                                        <tr>
                                            <th data-column-id="id" data-type="numeric">#</th>
                                            <th data-column-id="name">Name</th>
                                            <th data-column-id="options" data-formatter="commands" data-sortable="false">Options</th>
                                        </tr>
                                    </thead>
                                    <%if (facilities.length > 0) { %>
                                    <tbody>
                                        <% for(var i=0; i<facilities.length; i++) {%>
                                            <tr class="quote">
                                                <td id=""> <%= i+1 %> </td>
                                                <td id=""> <%= facilities[i].name %> </td>
                                            </tr>
                                        <% } %>
                                    </tbody>
                                    <% } else{ %>  
                                        <tbody>
                                            <!--<p>No products</p>-->
                                        </tbody>
                                    <% } %>
                                </table>
                            </div>
                        </div>
                    <div class="row">
                        <div class="col-md-12">
                            <h4>Products</h4>
                            <table id='grid-products' border="1" class="table table-bordered table-condensed table-hover table-striped" >
                                <thead>
                                    <tr>
                                        <th data-column-id="id" data-type="numeric">#</th>
                                        <th data-column-id="name">Name</th>
                                        <th data-column-id="options" data-formatter="commands" data-sortable="false">Options</th>
                                    </tr>
                                </thead>
                                <%if (products.length > 0) { %>
                                <tbody>
                                    <% for(var i=0; i<products.length; i++) {%>
                                        <tr class="quote">
                                            <td id=""> <%= i+1 %> </td>
                                            <td id=""> <%= products[i].name %> </td>
                                        </tr>
                                    <% } %>
                                </tbody>
                                <% } else{ %>  
                                    <tbody>
                                        <!--<p>No products</p>-->
                                    </tbody>
                                <% } %>
                            </table>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <h4>Sands</h4>
                            <table id='grid-sands' border="1" class="table table-bordered table-condensed table-hover table-striped" >
                                <thead>
                                    <tr>
                                        <th data-column-id="id" data-type="numeric">#</th>
                                        <th data-column-id="name">Name</th>
                                        <th data-column-id="options" data-formatter="commands" data-sortable="false">Options</th>
                                    </tr>
                                </thead>
                                <%if (sands.length > 0) { %>
                                <tbody>
                                    <% for(var i=0; i<sands.length; i++) {%>
                                        <tr class="quote">
                                            <td id=""> <%= i+1 %> </td>
                                            <td id=""> <%= sands[i].name %> </td>
                                        </tr>
                                    <% } %>
                                </tbody>
                                <% } else{ %>  
                                    <tbody>
                                        <!--<p>No sands</p>-->
                                    </tbody>
                                <% } %>
                            </table>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <!-- <script src="/socket.io/socket.io.js"></script>  -->
    <%include ../partials/js %>

    <!-- Ticket detail modal  -->
    <%include ../partials/ticket-detail %>


    <!--
        Inicializa el bootgrid y sus opciones, TODO: ver si se puede alimentar esto desde un endpoint
    -->
    <script>
        (function(APP){
            APP.SERVICE = APP.SERVICE || {};

            APP.SERVICE.ADMINISTRATIVE = APP.SERVICE.ADMINISTRATIVE || {};

            APP.LOAD = APP.LOAD || {};

            //page load functionality first!
            APP.LOAD.SIDE_BAR = APP.LOAD.SIDE_BAR || function () {
                $('#sidebarCollapse').on('click', function () {
                    $('#sidebar').toggleClass('active');
                });
            };

            APP.LOAD.GRID_LOCATIONS = APP.LOAD.GRID_LOCATIONS || function(){

                var linkFormatter = function(column, row){
                    return "<a href='../locations/"+ row.id +"' class='text-center black-link'>" + row.id + "</a>";
                };  

                var commandsFormatter = function(column, row) {
                    return "<button type=\"button\" class=\"btn btn-xs btn-default command-edit\" data-row-id=\"" + row.id + "\"><span class=\"fa fa-pencil\"></span></button> " + 
                            "<button type=\"button\" class=\"btn btn-xs btn-default command-delete\" data-row-id=\"" + row.id + "\"><span class=\"fa fa-trash-o\"></span></button>";
                };

                var loadedRsJQueryBootgrid = function(){
                    /* Executes after data is loaded and rendered */
                    var onClickEdit = function(e){
                        alert("edit");
                    };

                    var onClickDelete = function(e){
                        alert("delete");
                    };

                    $("#grid-basic")
                        .find(".command-edit")
                        .on("click", onClickEdit)
                        .end()
                        .find(".command-delete")
                        .on("click", onClickDelete);
                };

                $("#grid-locations")
                    .bootgrid({
                        formatters: {
                            "link": linkFormatter,
                            "commands": commandsFormatter
                        },
                        templates: {
                            search: ""
                        }
                    })
                    .on("loaded.rs.jquery.bootgrid", loadedRsJQueryBootgrid);
            };

            APP.LOAD.GRID_PRODUCTS = APP.LOAD.GRID_PRODUCTS || function(){

                var commandsFormatter = function(column, row) {
                    return "<button type=\"button\" class=\"btn btn-xs btn-default command-edit\" data-row-id=\"" + row.id + "\"><span class=\"fa fa-pencil\"></span></button> " + 
                            "<button type=\"button\" class=\"btn btn-xs btn-default command-delete\" data-row-id=\"" + row.id + "\"><span class=\"fa fa-trash-o\"></span></button>";
                };

                var loadedRsJQueryBootgrid = function(){
                    /* Executes after data is loaded and rendered */
                    var onClickEdit = function(e){
                        alert("edit");
                    };

                    var onClickDelete = function(e){
                        alert("delete");
                    };

                    $("#grid-basic")
                        .find(".command-edit")
                        .on("click", onClickEdit)
                        .end()
                        .find(".command-delete")
                        .on("click", onClickDelete);
                };

                $("#grid-products")
                    .bootgrid({
                        formatters: {
                            "commands": commandsFormatter
                        },
                        templates: {
                            search: ""
                        }
                    })
                    .on("loaded.rs.jquery.bootgrid", loadedRsJQueryBootgrid);
            };

            APP.LOAD.GRID_FACILITIES = APP.LOAD.GRID_FACILITIES || function(){

                var commandsFormatter = function(column, row) {
                    return "<button type=\"button\" class=\"btn btn-xs btn-default command-edit\" data-row-id=\"" + row.id + "\"><span class=\"fa fa-pencil\"></span></button> " + 
                            "<button type=\"button\" class=\"btn btn-xs btn-default command-delete\" data-row-id=\"" + row.id + "\"><span class=\"fa fa-trash-o\"></span></button>";
                };

                var loadedRsJQueryBootgrid = function(){
                    /* Executes after data is loaded and rendered */
                    var onClickEdit = function(e){
                        alert("edit");
                    };

                    var onClickDelete = function(e){
                        alert("delete");
                    };

                    $("#grid-basic")
                        .find(".command-edit")
                        .on("click", onClickEdit)
                        .end()
                        .find(".command-delete")
                        .on("click", onClickDelete);
                };

                $("#grid-facilities")
                    .bootgrid({
                        formatters: {
                            "commands": commandsFormatter
                        },
                        templates: {
                            search: ""
                        }
                    })
                    .on("loaded.rs.jquery.bootgrid", loadedRsJQueryBootgrid);
            };

            APP.LOAD.GRID_SANDS = APP.LOAD.GRID_SANDS || function(){

                var commandsFormatter = function(column, row) {
                    return "<button type=\"button\" class=\"btn btn-xs btn-default command-edit\" data-row-id=\"" + row.id + "\"><span class=\"fa fa-pencil\"></span></button> " + 
                            "<button type=\"button\" class=\"btn btn-xs btn-default command-delete\" data-row-id=\"" + row.id + "\"><span class=\"fa fa-trash-o\"></span></button>";
                };

                var loadedRsJQueryBootgrid = function(){
                    /* Executes after data is loaded and rendered */
                    var onClickEdit = function(e){
                        alert("edit");
                    };

                    var onClickDelete = function(e){
                        alert("delete");
                    };

                    $("#grid-basic")
                        .find(".command-edit")
                        .on("click", onClickEdit)
                        .end()
                        .find(".command-delete")
                        .on("click", onClickDelete);
                };

                $("#grid-sands")
                    .bootgrid({
                        formatters: {
                            "commands": commandsFormatter
                        },
                        templates: {
                            search: ""
                        }
                    })
                    .on("loaded.rs.jquery.bootgrid", loadedRsJQueryBootgrid);
            };
             
            APP.LOAD.SIDE_BAR();
            APP.LOAD.GRID_LOCATIONS();
            APP.LOAD.GRID_PRODUCTS();
            APP.LOAD.GRID_FACILITIES();
            APP.LOAD.GRID_SANDS();
        })(window);
    </script>


</body>
</html>